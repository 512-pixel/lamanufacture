<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LA MANUFACTURE — Prêt-à-Porter</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
  :root {
    --noir:#0a0a0a; --blanc:#f5f0eb; --creme:#e8ddd0; --or:#c9a96e;
    --gris:#4a4a4a; --gris-clair:#9a9a9a; --fond:#f5f0eb;
  }
  *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
  html{scroll-behavior:smooth}
  body{font-family:'Montserrat',sans-serif;background:var(--fond);color:var(--noir);overflow-x:hidden}

  /* ── CURSOR ── */
  .cursor{width:10px;height:10px;background:var(--or);border-radius:50%;position:fixed;top:0;left:0;pointer-events:none;z-index:9999;transform:translate(-50%,-50%);transition:width .3s,height .3s;mix-blend-mode:multiply}
  .cursor-ring{width:36px;height:36px;border:1px solid var(--or);border-radius:50%;position:fixed;top:0;left:0;pointer-events:none;z-index:9998;transform:translate(-50%,-50%);transition:transform .3s ease,width .3s,height .3s;opacity:.6}
  @media(hover:none){.cursor,.cursor-ring{display:none}}

  /* ── CONFIG BANNER ── */
  #configBanner{display:none;position:fixed;top:0;left:0;width:100%;background:#e74c3c;color:white;text-align:center;padding:.7rem;font-size:.65rem;letter-spacing:.1em;z-index:9999;font-family:'Montserrat',sans-serif}
  #configBanner a{color:white;font-weight:600;text-decoration:underline}

  /* ── NAV ── */
  nav{position:fixed;top:0;left:0;width:100%;display:flex;align-items:center;justify-content:space-between;padding:1.2rem 4rem;background:rgba(245,240,235,.92);backdrop-filter:blur(12px);z-index:1000;border-bottom:1px solid rgba(201,169,110,.2);transition:top .3s}
  nav.with-banner{top:38px}
  .nav-logo{font-family:'Cormorant Garamond',serif;font-size:1.6rem;font-weight:300;letter-spacing:.3em;color:var(--noir);text-decoration:none}
  .nav-logo span{color:var(--or)}
  .nav-links{display:flex;gap:2.5rem;list-style:none}
  .nav-links a{font-size:.65rem;font-weight:500;letter-spacing:.2em;text-transform:uppercase;color:var(--gris);text-decoration:none;position:relative;padding-bottom:2px;transition:color .3s;cursor:pointer}
  .nav-links a::after{content:'';position:absolute;bottom:0;left:0;width:0;height:1px;background:var(--or);transition:width .3s}
  .nav-links a:hover{color:var(--noir)}
  .nav-links a:hover::after{width:100%}
  .nav-actions{display:flex;align-items:center;gap:1.5rem}
  .nav-icon{background:none;border:none;cursor:pointer;position:relative}
  .nav-icon svg{width:20px;height:20px;stroke:var(--gris);fill:none;stroke-width:1.5;transition:stroke .3s}
  .nav-icon:hover svg{stroke:var(--noir)}
  .cart-count{position:absolute;top:-6px;right:-6px;background:var(--or);color:white;font-size:.5rem;font-weight:600;width:16px;height:16px;border-radius:50%;display:flex;align-items:center;justify-content:center}
  .hamburger{display:none;flex-direction:column;gap:5px;background:none;border:none;cursor:pointer}
  .hamburger span{width:24px;height:1px;background:var(--noir);transition:.3s}

  /* ── MARQUEE ── */
  .marquee-wrap{position:fixed;top:64px;left:0;width:100%;z-index:999;overflow:hidden;border-top:1px solid var(--creme);border-bottom:1px solid var(--creme);padding:.7rem 0;background:var(--fond)}
  .marquee-wrap.with-banner{top:calc(38px + 64px)}
  .marquee-track{display:flex;gap:4rem;animation:marquee 25s linear infinite;width:max-content}
  .marquee-item{font-size:.6rem;letter-spacing:.35em;text-transform:uppercase;color:var(--or);font-weight:500;white-space:nowrap;display:flex;align-items:center;gap:4rem}
  .marquee-item::after{content:'✦';font-size:.5rem}
  @keyframes marquee{to{transform:translateX(-50%)}}

  /* ── HERO ── */
  .hero{min-height:100vh;display:grid;grid-template-columns:1fr 1fr;padding-top:110px;overflow:hidden}
  .hero-text{display:flex;flex-direction:column;justify-content:center;padding:6rem 4rem 6rem 8rem;position:relative}
  .hero-text::before{content:'SS25';font-family:'Cormorant Garamond',serif;font-size:12rem;font-weight:300;color:rgba(201,169,110,.06);position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);white-space:nowrap;pointer-events:none}
  .hero-sub{font-size:.6rem;letter-spacing:.4em;text-transform:uppercase;color:var(--or);margin-bottom:1.5rem;animation:fadeUp 1s ease both}
  .hero-title{font-family:'Cormorant Garamond',serif;font-size:clamp(3rem,6vw,5.5rem);font-weight:300;line-height:1.05;margin-bottom:2rem;animation:fadeUp 1s .15s ease both}
  .hero-title em{font-style:italic;color:var(--or)}
  .hero-desc{font-size:.75rem;line-height:1.9;color:var(--gris);max-width:340px;margin-bottom:3rem;animation:fadeUp 1s .3s ease both}
  .hero-cta{display:flex;gap:1.2rem;flex-wrap:wrap;animation:fadeUp 1s .45s ease both}
  .btn-primary{background:var(--noir);color:var(--blanc);padding:1rem 2.4rem;font-size:.6rem;letter-spacing:.25em;text-transform:uppercase;font-weight:500;border:none;cursor:pointer;text-decoration:none;transition:background .3s;display:inline-block}
  .btn-primary:hover{background:var(--or)}
  .btn-outline{background:transparent;color:var(--noir);padding:1rem 2.4rem;font-size:.6rem;letter-spacing:.25em;text-transform:uppercase;font-weight:500;border:1px solid var(--noir);cursor:pointer;text-decoration:none;transition:background .3s,color .3s;display:inline-block}
  .btn-outline:hover{background:var(--noir);color:var(--blanc)}
  .hero-image{position:relative;overflow:hidden;animation:fadeIn 1.2s ease both}
  .hero-image-inner{width:100%;height:100%;background:linear-gradient(135deg,#2a2a2a 0%,#1a1a1a 50%,#3a2a1a 100%);display:flex;align-items:center;justify-content:center}
  .hero-figure{width:60%;max-width:320px;position:relative;z-index:2}
  .hero-badge{position:absolute;bottom:3rem;left:-2rem;background:var(--or);color:white;padding:1.2rem 1.5rem;font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;font-weight:600;z-index:3}
  .hero-badge strong{display:block;font-size:1.2rem;font-family:'Cormorant Garamond',serif;font-weight:400;letter-spacing:0}

  /* ── SECTIONS ── */
  .section{padding:6rem 4rem}
  .section-header{text-align:center;margin-bottom:3.5rem}
  .section-label{font-size:.6rem;letter-spacing:.4em;text-transform:uppercase;color:var(--or);margin-bottom:.8rem;display:block}
  .section-title{font-family:'Cormorant Garamond',serif;font-size:clamp(2rem,4vw,3.5rem);font-weight:300}

  /* ── CATEGORIES ── */
  .categories-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:1.5rem}
  .cat-card{position:relative;overflow:hidden;cursor:pointer;aspect-ratio:3/4;transition:transform .4s}
  .cat-card:hover{transform:translateY(-6px)}
  .cat-card:hover .cat-bg-inner{transform:scale(1.06)}
  .cat-bg{width:100%;height:100%;overflow:hidden}
  .cat-bg-inner{width:100%;height:100%;transition:transform .6s ease;display:flex;align-items:center;justify-content:center}
  .cat-info{position:absolute;bottom:0;left:0;right:0;padding:2rem 1.5rem 1.5rem;background:linear-gradient(to top,rgba(0,0,0,.8) 0%,transparent 100%)}
  .cat-name{font-family:'Cormorant Garamond',serif;font-size:1.4rem;font-weight:300;color:white;letter-spacing:.05em;display:block;margin-bottom:.3rem}
  .cat-count{font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:rgba(255,255,255,.6)}

  /* ── FILTERS ── */
  .products-section{padding:2rem 4rem 6rem}
  .filters-bar{display:flex;align-items:center;justify-content:space-between;margin-bottom:2.5rem;flex-wrap:wrap;gap:1rem}
  .filter-chips{display:flex;gap:.6rem;flex-wrap:wrap}
  .chip{padding:.5rem 1.2rem;border:1px solid var(--creme);font-size:.6rem;letter-spacing:.15em;text-transform:uppercase;cursor:pointer;background:transparent;transition:background .25s,border-color .25s,color .25s;font-family:'Montserrat',sans-serif;color:var(--gris)}
  .chip.active,.chip:hover{background:var(--noir);border-color:var(--noir);color:white}
  .sort-select{font-family:'Montserrat',sans-serif;font-size:.6rem;letter-spacing:.15em;text-transform:uppercase;border:1px solid var(--creme);background:transparent;padding:.5rem 2rem .5rem 1rem;cursor:pointer;color:var(--gris);appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6'%3E%3Cpath d='M0 0l5 6 5-6z' fill='%239a9a9a'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right .8rem center}

  /* ── PRODUCTS ── */
  .products-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:2rem}
  .product-card{cursor:pointer;position:relative;transition:transform .3s}
  .product-card:hover{transform:translateY(-4px)}
  .product-card:hover .product-actions{opacity:1;transform:translateY(0)}
  .product-card:hover .product-thumb{transform:scale(1.04)}
  .product-img-wrap{overflow:hidden;aspect-ratio:3/4;position:relative;margin-bottom:1.2rem;background:var(--creme)}
  .product-thumb{width:100%;height:100%;object-fit:cover;transition:transform .5s ease}
  .product-thumb.placeholder-img{display:flex;align-items:center;justify-content:center;background:var(--creme)}
  .badge-new{position:absolute;top:1rem;left:1rem;background:var(--noir);color:white;font-size:.5rem;letter-spacing:.2em;padding:.3rem .7rem;text-transform:uppercase}
  .badge-sale{position:absolute;top:1rem;left:1rem;background:var(--or);color:white;font-size:.5rem;letter-spacing:.2em;padding:.3rem .7rem;text-transform:uppercase}
  .wishlist-btn{position:absolute;top:1rem;right:1rem;background:white;border:none;cursor:pointer;width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .3s;box-shadow:0 2px 8px rgba(0,0,0,.1)}
  .product-card:hover .wishlist-btn{opacity:1}
  .wishlist-btn svg{width:14px;height:14px;stroke:var(--gris);fill:none;stroke-width:1.5;transition:stroke .2s,fill .2s}
  .wishlist-btn.active svg{stroke:#e74c3c;fill:#e74c3c}
  .product-actions{position:absolute;bottom:0;left:0;right:0;padding:1rem;opacity:0;transform:translateY(10px);transition:opacity .3s,transform .3s}
  .size-quick{display:flex;gap:.4rem;margin-bottom:.6rem;flex-wrap:wrap}
  .size-btn{background:white;border:1px solid var(--creme);font-size:.5rem;font-weight:600;padding:.3rem .5rem;cursor:pointer;font-family:'Montserrat',sans-serif;transition:background .2s,border-color .2s;min-width:32px;text-align:center}
  .size-btn:hover,.size-btn.selected{background:var(--noir);color:white;border-color:var(--noir)}
  .size-btn.unavailable{opacity:.3;cursor:not-allowed}
  .add-to-cart{width:100%;background:var(--noir);color:white;border:none;cursor:pointer;font-family:'Montserrat',sans-serif;font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;padding:.75rem;transition:background .3s;font-weight:500}
  .add-to-cart:hover{background:var(--or)}
  .product-meta{padding:0 .2rem}
  .product-brand{font-size:.5rem;letter-spacing:.2em;text-transform:uppercase;color:var(--or);margin-bottom:.3rem}
  .product-name{font-family:'Cormorant Garamond',serif;font-size:1.1rem;font-weight:400;margin-bottom:.5rem}
  .product-price{display:flex;gap:.8rem;align-items:baseline}
  .price-current{font-size:.9rem;font-weight:500}
  .price-old{font-size:.75rem;color:var(--gris-clair);text-decoration:line-through}
  .add-mobile{display:none;width:100%;background:var(--noir);color:white;border:none;cursor:pointer;font-family:'Montserrat',sans-serif;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;padding:.65rem;margin-top:.6rem;font-weight:500}
  @media(hover:none){.add-mobile{display:block}.product-actions{display:none!important}}

  /* ── LOADING / EMPTY ── */
  .skeleton-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:2rem}
  .skeleton-card{background:var(--creme);animation:pulse 1.5s ease-in-out infinite}
  .skeleton-img{aspect-ratio:3/4;background:linear-gradient(90deg,var(--creme) 25%,#ddd4c0 50%,var(--creme) 75%);background-size:200% 100%;animation:shimmer 1.5s infinite}
  .skeleton-line{height:12px;margin:8px 0;border-radius:2px;background:linear-gradient(90deg,var(--creme) 25%,#ddd4c0 50%,var(--creme) 75%);background-size:200% 100%;animation:shimmer 1.5s infinite}
  .skeleton-line.short{width:60%}
  @keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}
  @keyframes pulse{0%,100%{opacity:1}50%{opacity:.7}}
  .empty-state{text-align:center;padding:5rem 2rem;grid-column:1/-1}
  .empty-state p{font-family:'Cormorant Garamond',serif;font-size:1.5rem;font-weight:300;color:var(--gris);margin-bottom:.5rem}
  .empty-state span{font-size:.65rem;color:var(--gris-clair);letter-spacing:.1em}

  /* ── CART ── */
  .cart-modal{position:fixed;inset:0;z-index:2000;display:flex;justify-content:flex-end;opacity:0;pointer-events:none;transition:opacity .3s}
  .cart-modal.open{opacity:1;pointer-events:all}
  .cart-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.5)}
  .cart-panel{position:relative;z-index:1;width:min(420px,100vw);background:var(--fond);display:flex;flex-direction:column;transform:translateX(100%);transition:transform .4s cubic-bezier(.4,0,.2,1);overflow:hidden}
  .cart-modal.open .cart-panel{transform:translateX(0)}
  .cart-header{padding:2rem;border-bottom:1px solid var(--creme);display:flex;justify-content:space-between;align-items:center}
  .cart-title{font-family:'Cormorant Garamond',serif;font-size:1.6rem;font-weight:300}
  .cart-close{background:none;border:none;cursor:pointer;font-size:1.5rem;color:var(--gris)}
  .cart-items{flex:1;overflow-y:auto;padding:1.5rem 2rem}
  .cart-item{display:flex;gap:1rem;margin-bottom:1.5rem;padding-bottom:1.5rem;border-bottom:1px solid var(--creme)}
  .cart-item-img{width:80px;height:100px;background:var(--creme);flex-shrink:0;overflow:hidden}
  .cart-item-img img{width:100%;height:100%;object-fit:cover}
  .cart-item-info{flex:1}
  .cart-item-name{font-family:'Cormorant Garamond',serif;font-size:1rem;margin-bottom:.3rem}
  .cart-item-size{font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--gris-clair);margin-bottom:.5rem}
  .cart-item-price{font-size:.85rem;font-weight:500}
  .cart-qty{display:flex;align-items:center;gap:.5rem;margin-top:.5rem}
  .qty-btn{background:var(--creme);border:none;cursor:pointer;width:24px;height:24px;font-size:.8rem;display:flex;align-items:center;justify-content:center}
  .qty-val{font-size:.75rem;font-weight:500;min-width:20px;text-align:center}
  .cart-item-remove{background:none;border:none;cursor:pointer;color:var(--gris-clair);font-size:.6rem;letter-spacing:.1em;text-transform:uppercase;text-decoration:underline;margin-top:.5rem;padding:0;display:block;font-family:'Montserrat',sans-serif}
  .cart-footer{padding:1.5rem 2rem;border-top:1px solid var(--creme)}
  .cart-total{display:flex;justify-content:space-between;margin-bottom:1.5rem}
  .cart-total-label{font-size:.6rem;letter-spacing:.2em;text-transform:uppercase;color:var(--gris)}
  .cart-total-amount{font-family:'Cormorant Garamond',serif;font-size:1.5rem}
  .checkout-btn{width:100%;background:var(--noir);color:white;border:none;cursor:pointer;padding:1.1rem;font-family:'Montserrat',sans-serif;font-size:.6rem;letter-spacing:.25em;text-transform:uppercase;font-weight:500;transition:background .3s}
  .checkout-btn:hover{background:var(--or)}
  .cart-empty{text-align:center;padding:3rem;color:var(--gris-clair)}
  .cart-empty p{font-family:'Cormorant Garamond',serif;font-size:1.3rem;font-weight:300;margin-bottom:1rem}

  /* ── NEWSLETTER ── */
  .newsletter{background:var(--noir);color:var(--blanc);padding:6rem 4rem;text-align:center;position:relative;overflow:hidden}
  .newsletter::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at center,rgba(201,169,110,.08) 0%,transparent 70%)}
  .newsletter-title{font-family:'Cormorant Garamond',serif;font-size:clamp(2rem,4vw,3.5rem);font-weight:300;margin-bottom:1rem;position:relative}
  .newsletter-sub{font-size:.7rem;color:rgba(255,255,255,.5);letter-spacing:.1em;margin-bottom:2.5rem;position:relative}
  .newsletter-form{display:flex;max-width:480px;margin:0 auto;position:relative}
  .newsletter-input{flex:1;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.15);border-right:none;padding:1rem 1.5rem;font-family:'Montserrat',sans-serif;font-size:.7rem;color:white;outline:none;transition:border-color .3s}
  .newsletter-input::placeholder{color:rgba(255,255,255,.3)}
  .newsletter-input:focus{border-color:var(--or)}
  .newsletter-btn{background:var(--or);border:none;cursor:pointer;padding:1rem 1.8rem;font-family:'Montserrat',sans-serif;font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;font-weight:600;color:white;transition:background .3s}
  .newsletter-btn:hover{background:#b8935a}

  /* ── FOOTER ── */
  footer{background:#080808;color:rgba(255,255,255,.5);padding:4rem}
  .footer-grid{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:3rem;margin-bottom:3rem}
  .footer-brand{font-family:'Cormorant Garamond',serif;font-size:1.8rem;font-weight:300;color:white;letter-spacing:.2em;margin-bottom:1rem}
  .footer-desc{font-size:.65rem;line-height:1.8;max-width:260px}
  .footer-heading{font-size:.55rem;letter-spacing:.3em;text-transform:uppercase;color:var(--or);margin-bottom:1.2rem;font-weight:600}
  .footer-links{list-style:none}
  .footer-links li{margin-bottom:.7rem}
  .footer-links a{font-size:.65rem;color:rgba(255,255,255,.5);text-decoration:none;transition:color .3s}
  .footer-links a:hover{color:white}
  .footer-bottom{border-top:1px solid rgba(255,255,255,.06);padding-top:2rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem}
  .footer-copy{font-size:.55rem;letter-spacing:.1em}
  .footer-social{display:flex;gap:1rem}
  .social-link{width:32px;height:32px;border:1px solid rgba(255,255,255,.1);display:flex;align-items:center;justify-content:center;text-decoration:none;transition:border-color .3s,background .3s}
  .social-link:hover{border-color:var(--or);background:var(--or)}
  .social-link svg{width:14px;height:14px;fill:rgba(255,255,255,.6)}
  .social-link:hover svg{fill:white}

  /* ── TOAST ── */
  .toast{position:fixed;bottom:2rem;left:50%;transform:translateX(-50%) translateY(100px);background:var(--noir);color:white;padding:.9rem 2rem;font-size:.6rem;letter-spacing:.15em;text-transform:uppercase;z-index:3000;transition:transform .4s cubic-bezier(.4,0,.2,1);display:flex;align-items:center;gap:.8rem;white-space:nowrap}
  .toast.show{transform:translateX(-50%) translateY(0)}
  .toast-icon{width:16px;height:16px;background:var(--or);border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}

  /* ── MOBILE MENU ── */
  .mobile-menu{position:fixed;inset:0;z-index:1500;background:var(--fond);display:flex;flex-direction:column;padding:6rem 3rem 3rem;transform:translateX(-100%);transition:transform .4s cubic-bezier(.4,0,.2,1)}
  .mobile-menu.open{transform:translateX(0)}
  .mobile-menu a{font-family:'Cormorant Garamond',serif;font-size:2.5rem;font-weight:300;color:var(--noir);text-decoration:none;padding:.8rem 0;border-bottom:1px solid var(--creme);display:block;transition:color .3s,padding-left .3s;cursor:pointer}
  .mobile-menu a:hover{color:var(--or);padding-left:.5rem}
  .mobile-close{position:absolute;top:1.5rem;right:2rem;background:none;border:none;font-size:1.8rem;cursor:pointer;color:var(--gris)}

  /* ── ANIMATIONS ── */
  @keyframes fadeUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
  @keyframes fadeIn{from{opacity:0}to{opacity:1}}
  .fade-up{opacity:0;transform:translateY(30px);transition:opacity .7s ease,transform .7s ease}
  .fade-up.visible{opacity:1;transform:translateY(0)}

  /* ── RESPONSIVE ── */
  @media(max-width:1024px){
    nav{padding:1.2rem 2rem}
    .nav-links{display:none}
    .hamburger{display:flex}
    .hero{grid-template-columns:1fr;min-height:auto}
    .hero-text{padding:4rem 2rem;order:2}
    .hero-text::before{font-size:6rem}
    .hero-image{height:60vw;order:1}
    .hero-badge{left:1rem;bottom:1rem}
    .section{padding:4rem 2rem}
    .categories-grid{grid-template-columns:repeat(2,1fr)}
    .products-section{padding:2rem 2rem 4rem}
    .footer-grid{grid-template-columns:1fr 1fr}
    .newsletter{padding:4rem 2rem}
    .marquee-wrap{top:60px}
  }
  @media(max-width:600px){
    .categories-grid{grid-template-columns:1fr 1fr;gap:1rem}
    .products-grid{grid-template-columns:repeat(2,1fr);gap:1rem}
    .footer-grid{grid-template-columns:1fr;gap:2rem}
    .newsletter-form{flex-direction:column}
    .newsletter-input{border-right:1px solid rgba(255,255,255,.15);border-bottom:none}
    .hero-cta{flex-direction:column}
    .filters-bar{flex-direction:column;align-items:flex-start}
    footer{padding:2rem}
  }
  /* ── HERO PRODUCT HOVER ── */
  #heroProductCard:hover #heroOverlay{background:rgba(0,0,0,.35)!important}
  #heroProductCard:hover #heroOverlayBtn{opacity:1!important;transform:translateY(0)!important}
  #heroProductCard:hover .hero-image-inner img{transform:scale(1.04)}
  .hero-image-inner img{width:100%;height:100%;object-fit:cover;transition:transform .6s ease}

  ::-webkit-scrollbar{width:4px}
  ::-webkit-scrollbar-track{background:var(--creme)}
  ::-webkit-scrollbar-thumb{background:var(--or)}

  /* ── PAGE PRODUIT (overlay) ── */
  .pdp-overlay{position:fixed;inset:0;z-index:1800;background:var(--fond);overflow-y:auto;
    opacity:0;pointer-events:none;transform:translateY(30px);transition:opacity .35s ease,transform .35s ease}
  .pdp-overlay.open{opacity:1;pointer-events:all;transform:translateY(0)}
  .pdp-bar{position:sticky;top:0;z-index:10;background:rgba(245,240,235,.95);backdrop-filter:blur(12px);
    display:flex;align-items:center;justify-content:space-between;padding:1rem 3rem;
    border-bottom:1px solid rgba(201,169,110,.15)}
  .pdp-back{background:none;border:none;cursor:pointer;display:flex;align-items:center;gap:.6rem;
    font-size:.6rem;letter-spacing:.2em;text-transform:uppercase;color:var(--gris);font-family:'Montserrat',sans-serif;
    transition:color .2s}
  .pdp-back:hover{color:var(--noir)}
  .pdp-back svg{width:16px;height:16px;stroke:currentColor;fill:none;stroke-width:1.5}
  .pdp-breadcrumb{font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--gris-clair)}
  .pdp-breadcrumb span{color:var(--or)}

  .pdp-body{display:grid;grid-template-columns:1fr 1fr;gap:0;max-width:1400px;margin:0 auto;min-height:calc(100vh - 60px)}

  /* Galerie */
  .pdp-gallery{position:sticky;top:60px;height:calc(100vh - 60px);display:flex;flex-direction:column;gap:.8rem;padding:2rem}
  .pdp-main-img{flex:1;overflow:hidden;background:var(--creme);position:relative;cursor:zoom-in}
  .pdp-main-img img{width:100%;height:100%;object-fit:cover;transition:transform .4s ease}
  .pdp-main-img:hover img{transform:scale(1.04)}
  .pdp-main-img .placeholder-gallery{width:100%;height:100%;display:flex;align-items:center;justify-content:center}
  .pdp-thumbs{display:flex;gap:.6rem;overflow-x:auto;padding-bottom:.2rem;flex-shrink:0}
  .pdp-thumbs::-webkit-scrollbar{height:2px}
  .pdp-thumb{width:72px;height:90px;flex-shrink:0;cursor:pointer;overflow:hidden;border:2px solid transparent;
    transition:border-color .2s;opacity:.6;transition:opacity .2s,border-color .2s}
  .pdp-thumb.active,.pdp-thumb:hover{border-color:var(--or);opacity:1}
  .pdp-thumb img{width:100%;height:100%;object-fit:cover}

  /* Navigation galerie (flèches) */
  .pdp-gallery-nav{position:absolute;top:50%;transform:translateY(-50%);background:white;border:none;
    width:36px;height:36px;cursor:pointer;display:flex;align-items:center;justify-content:center;
    box-shadow:0 2px 12px rgba(0,0,0,.1);transition:background .2s,transform .2s;z-index:2}
  .pdp-gallery-nav:hover{background:var(--or)}
  .pdp-gallery-nav:hover svg{stroke:white}
  .pdp-gallery-nav svg{width:14px;height:14px;stroke:var(--gris);fill:none;stroke-width:2}
  .pdp-gallery-nav.prev{left:.8rem}
  .pdp-gallery-nav.next{right:.8rem}

  /* Lightbox */
  .pdp-lightbox{position:fixed;inset:0;z-index:3000;background:rgba(0,0,0,.92);display:flex;
    align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .3s}
  .pdp-lightbox.open{opacity:1;pointer-events:all}
  .pdp-lightbox img{max-width:90vw;max-height:90vh;object-fit:contain}
  .pdp-lightbox-close{position:absolute;top:1.5rem;right:2rem;background:none;border:none;
    color:white;font-size:2rem;cursor:pointer;line-height:1}
  .pdp-lightbox-nav{position:absolute;top:50%;transform:translateY(-50%);background:rgba(255,255,255,.1);
    border:1px solid rgba(255,255,255,.2);color:white;width:44px;height:44px;cursor:pointer;
    font-size:1.2rem;display:flex;align-items:center;justify-content:center;transition:background .2s}
  .pdp-lightbox-nav:hover{background:rgba(255,255,255,.25)}
  .pdp-lightbox-nav.prev{left:2rem}
  .pdp-lightbox-nav.next{right:2rem}
  .pdp-lightbox-counter{position:absolute;bottom:1.5rem;left:50%;transform:translateX(-50%);
    color:rgba(255,255,255,.5);font-size:.6rem;letter-spacing:.2em}

  /* Infos produit */
  .pdp-info{padding:4rem 4rem 4rem 5rem;display:flex;flex-direction:column}
  .pdp-brand{font-size:.55rem;letter-spacing:.3em;text-transform:uppercase;color:var(--or);margin-bottom:.8rem}
  .pdp-name{font-family:'Cormorant Garamond',serif;font-size:clamp(2rem,3.5vw,3rem);font-weight:300;
    line-height:1.1;margin-bottom:1rem}
  .pdp-price-block{display:flex;align-items:baseline;gap:1rem;margin-bottom:2rem;padding-bottom:2rem;
    border-bottom:1px solid var(--creme)}
  .pdp-price{font-size:1.6rem;font-weight:500;font-family:'Cormorant Garamond',serif}
  .pdp-old-price{font-size:1rem;color:var(--gris-clair);text-decoration:line-through}
  .pdp-discount{background:var(--or);color:white;font-size:.5rem;letter-spacing:.15em;
    text-transform:uppercase;padding:.3rem .7rem;font-weight:600}

  .pdp-section-title{font-size:.55rem;letter-spacing:.25em;text-transform:uppercase;color:var(--gris);
    font-weight:600;margin-bottom:.8rem}
  .pdp-sizes{display:flex;gap:.5rem;flex-wrap:wrap;margin-bottom:2rem}
  .pdp-size-btn{min-width:44px;height:44px;padding:0 .8rem;border:1px solid var(--creme);background:white;
    font-family:'Montserrat',sans-serif;font-size:.6rem;font-weight:500;cursor:pointer;
    transition:background .2s,border-color .2s,color .2s;display:flex;align-items:center;justify-content:center}
  .pdp-size-btn:hover:not(.na-size){background:var(--noir);border-color:var(--noir);color:white}
  .pdp-size-btn.selected-size{background:var(--noir);border-color:var(--noir);color:white}
  .pdp-size-btn.na-size{opacity:.3;cursor:not-allowed;text-decoration:line-through;position:relative}

  .pdp-cta{display:flex;flex-direction:column;gap:.8rem;margin-bottom:2.5rem}
  .pdp-add-btn{background:var(--noir);color:white;border:none;padding:1.1rem;font-family:'Montserrat',sans-serif;
    font-size:.6rem;letter-spacing:.25em;text-transform:uppercase;cursor:pointer;transition:background .3s;font-weight:500}
  .pdp-add-btn:hover{background:var(--or)}
  .pdp-wish-btn{background:transparent;color:var(--gris);border:1px solid var(--creme);padding:1rem;
    font-family:'Montserrat',sans-serif;font-size:.6rem;letter-spacing:.2em;text-transform:uppercase;
    cursor:pointer;transition:border-color .2s,color .2s;display:flex;align-items:center;justify-content:center;gap:.5rem}
  .pdp-wish-btn svg{width:14px;height:14px;stroke:currentColor;fill:none;stroke-width:1.5;transition:fill .2s}
  .pdp-wish-btn:hover,.pdp-wish-btn.active{border-color:var(--noir);color:var(--noir)}
  .pdp-wish-btn.active svg{fill:#e74c3c;stroke:#e74c3c}

  .pdp-desc{font-size:.75rem;line-height:1.9;color:var(--gris);margin-bottom:2rem}
  .pdp-meta{border-top:1px solid var(--creme);padding-top:1.5rem;display:grid;grid-template-columns:1fr 1fr;gap:.8rem}
  .pdp-meta-item{font-size:.6rem;color:var(--gris-clair);display:flex;align-items:center;gap:.5rem}
  .pdp-meta-item svg{width:14px;height:14px;stroke:var(--or);fill:none;stroke-width:1.5;flex-shrink:0}

  /* Accordéon détails */
  .pdp-accordion{border-top:1px solid var(--creme);margin-top:1.5rem}
  .pdp-acc-item{border-bottom:1px solid var(--creme)}
  .pdp-acc-trigger{width:100%;background:none;border:none;display:flex;justify-content:space-between;
    align-items:center;padding:1rem 0;cursor:pointer;font-family:'Montserrat',sans-serif;
    font-size:.6rem;letter-spacing:.15em;text-transform:uppercase;color:var(--gris);font-weight:500}
  .pdp-acc-trigger svg{width:12px;height:12px;stroke:var(--gris);fill:none;stroke-width:2;transition:transform .3s}
  .pdp-acc-trigger.open svg{transform:rotate(45deg)}
  .pdp-acc-content{max-height:0;overflow:hidden;transition:max-height .4s ease}
  .pdp-acc-content.open{max-height:300px}
  .pdp-acc-content p{font-size:.7rem;line-height:1.8;color:var(--gris);padding-bottom:1rem}

  /* Responsive page produit */
  @media(max-width:900px){
    .pdp-body{grid-template-columns:1fr}
    .pdp-gallery{position:relative;top:0;height:auto;min-height:70vw}
    .pdp-main-img{min-height:60vw}
    .pdp-info{padding:2rem}
    .pdp-bar{padding:1rem 1.5rem}
  }
  @media(max-width:600px){
    .pdp-info{padding:1.5rem}
    .pdp-name{font-size:1.8rem}
    .pdp-lightbox-nav{display:none}
  }
</style>
</head>
<body>

<!-- CONFIG BANNER -->
<div id="configBanner">
  ⚠️ Supabase non configuré — Modifiez les variables <code>SUPABASE_URL</code> et <code>SUPABASE_ANON_KEY</code> dans le fichier index.html &nbsp;|&nbsp;
  <a href="admin.html">Ouvrir l'admin →</a>
</div>

<div class="cursor" id="cursor"></div>
<div class="cursor-ring" id="cursor-ring"></div>

<!-- NAV -->
<nav id="mainNav">
  <a href="#" class="nav-logo">LA MANUFACTURE<span>.</span></a>
  <ul class="nav-links" id="navLinks">
    <li><a onclick="filterCat('Tous')">Tous</a></li>
    <li><a onclick="filterCat('Femme')">Femme</a></li>
    <li><a onclick="filterCat('Homme')">Homme</a></li>
    <li><a onclick="filterCat('Enfant')">Enfant</a></li>
    <li><a onclick="filterCat('Accessoires')">Accessoires</a></li>
    <li><a href="admin.html" style="color:var(--or)">Admin ⚙️</a></li>
  </ul>
  <div class="nav-actions">
    <button class="nav-icon" onclick="toggleCart()">
      <svg viewBox="0 0 24 24"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4zM3 6h18M16 10a4 4 0 01-8 0"/></svg>
      <span class="cart-count" id="cartCount">0</span>
    </button>
    <button class="hamburger" onclick="toggleMobileMenu()"><span></span><span></span><span></span></button>
  </div>
</nav>

<!-- MARQUEE (fixé juste sous le header) -->
<div class="marquee-wrap" id="marqueeWrap">
  <div class="marquee-track">
    <span class="marquee-item">Livraison offerte dès 150€</span>
    <span class="marquee-item">Nouvelle collection SS25</span>
    <span class="marquee-item">Retours gratuits 30 jours</span>
    <span class="marquee-item">Matières premium & durables</span>
    <span class="marquee-item">Service client 7j/7</span>
    <span class="marquee-item">Livraison offerte dès 150€</span>
    <span class="marquee-item">Nouvelle collection SS25</span>
    <span class="marquee-item">Retours gratuits 30 jours</span>
    <span class="marquee-item">Matières premium & durables</span>
    <span class="marquee-item">Service client 7j/7</span>
  </div>
</div>

<!-- Mobile Menu -->
<div class="mobile-menu" id="mobileMenu">
  <button class="mobile-close" onclick="toggleMobileMenu()">✕</button>
  <a onclick="filterCat('Tous');toggleMobileMenu()">Tous les produits</a>
  <a onclick="filterCat('Femme');toggleMobileMenu()">Femme</a>
  <a onclick="filterCat('Homme');toggleMobileMenu()">Homme</a>
  <a onclick="filterCat('Enfant');toggleMobileMenu()">Enfant</a>
  <a onclick="filterCat('Accessoires');toggleMobileMenu()">Accessoires</a>
  <a href="admin.html" style="color:var(--or)">Admin ⚙️</a>
</div>

<!-- HERO -->
<section class="hero">
  <div class="hero-text">
    <h1 class="hero-title">L'élégance<br>à l'état <em>pur</em></h1>
    <p class="hero-desc">Des pièces intemporelles conçues pour traverser les saisons. Matières nobles, coupes sculpturales, silhouettes affinées.</p>
    <div class="hero-cta">
      <a href="#products" class="btn-primary">Découvrir la collection</a>
      <a href="#categories" class="btn-outline">Catégories</a>
    </div>
  </div>
  <div class="hero-image" id="heroProductCard" onclick="heroOpenPDP()" style="cursor:pointer">
    <div class="hero-image-inner" id="heroImageInner">
      <!-- produit aléatoire injecté dynamiquement -->
      <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;opacity:.2;gap:1rem">
        <svg viewBox="0 0 100 120" width="80" xmlns="http://www.w3.org/2000/svg">
          <ellipse cx="50" cy="20" rx="14" ry="16" fill="#c9a96e"/>
          <path d="M22,50 Q15,70 18,100 L82,100 Q85,70 78,50 Q65,38 50,36 Q35,38 22,50Z" fill="#c9a96e"/>
        </svg>
      </div>
    </div>
    <!-- Overlay "Voir le produit" au hover -->
    <div style="position:absolute;inset:0;background:rgba(0,0,0,0);display:flex;align-items:flex-end;justify-content:center;padding-bottom:5rem;transition:background .3s;pointer-events:none" id="heroOverlay">
      <span style="background:var(--or);color:white;font-size:.55rem;letter-spacing:.25em;text-transform:uppercase;padding:.7rem 1.8rem;font-weight:600;opacity:0;transform:translateY(10px);transition:opacity .3s,transform .3s" id="heroOverlayBtn">Voir le produit →</span>
    </div>
  </div>
</section>

<!-- CATEGORIES -->
<section class="section" id="categories">
  <div class="section-header fade-up">
    <span class="section-label">Explorer</span>
    <h2 class="section-title">Nos Catégories</h2>
  </div>
  <div class="categories-grid fade-up" id="categoriesGrid">
    <!-- populated dynamically -->
  </div>
</section>

<!-- PRODUCTS -->
<section class="products-section" id="products">
  <div class="section-header fade-up">
    <span class="section-label">Sélection</span>
    <h2 class="section-title">Nos Produits</h2>
  </div>
  <div class="filters-bar fade-up">
    <div class="filter-chips" id="filterChips">
      <button class="chip active" onclick="filterCat('Tous')">Tous</button>
    </div>
    <select class="sort-select" onchange="sortProducts(this.value)">
      <option value="default">Trier par</option>
      <option value="price-asc">Prix croissant</option>
      <option value="price-desc">Prix décroissant</option>
      <option value="new">Nouveautés</option>
    </select>
  </div>
  <div class="products-grid" id="productsGrid">
    <!-- skeleton -->
  </div>
</section>

<!-- NEWSLETTER -->
<section class="newsletter">
  <h2 class="newsletter-title">Accès en avant-première</h2>
  <p class="newsletter-sub">Inscrivez-vous pour recevoir nos nouvelles collections et offres exclusives.</p>
  <div class="newsletter-form">
    <input class="newsletter-input" type="email" placeholder="Votre adresse email" id="emailInput">
    <button class="newsletter-btn" onclick="subscribeNewsletter()">S'inscrire</button>
  </div>
</section>

<!-- FOOTER -->
<footer>
  <div class="footer-grid">
    <div>
      <div class="footer-brand">LA MANUFACTURE<span style="color:var(--or)">.</span></div>
      <p class="footer-desc">Revendeur de mode fondée sur les principes d'élégance, d'authenticité et de savoir-faire artisanal.</p>
    </div>
    <div>
      <p class="footer-heading">Collections</p>
      <ul class="footer-links">
        <li><a href="#" onclick="filterCat('Femme')">Femme</a></li>
        <li><a href="#" onclick="filterCat('Homme')">Homme</a></li>
        <li><a href="#" onclick="filterCat('Enfant')">Enfant</a></li>
        <li><a href="#" onclick="filterCat('Accessoires')">Accessoires</a></li>
      </ul>
    </div>
    <div>
      <p class="footer-heading">Information</p>
      <ul class="footer-links">
        <li><a href="#">Livraison & retours</a></li>
        <li><a href="#">Guide des tailles</a></li>
        <li><a href="#">Mentions légales</a></li>
        <li><a href="#">Contact</a></li>
      </ul>
    </div>
    <div>
      <p class="footer-heading">Aide</p>
      <ul class="footer-links">
        <li><a href="#">FAQ</a></li>
        <li><a href="#">Suivi commande</a></li>
        <li><a href="admin.html">Administration</a></li>
      </ul>
    </div>
  </div>
  <div class="footer-bottom">
    <p class="footer-copy">© 2025 LA MANUFACTURE. Tous droits réservés.</p>
    <div class="footer-social">
      <a href="#" class="social-link"><svg viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073z"/></svg></a>
    </div>
  </div>
</footer>

<!-- PAGE PRODUIT (overlay SPA) -->
<div class="pdp-overlay" id="pdpOverlay" role="dialog" aria-modal="true">

  <!-- Barre de navigation -->
  <div class="pdp-bar">
    <button class="pdp-back" onclick="closePDP()">
      <svg viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg>
      Retour
    </button>
    <span class="pdp-breadcrumb" id="pdpBreadcrumb">Boutique / <span>—</span></span>
    <button class="nav-icon" onclick="toggleCart()" style="position:relative">
      <svg viewBox="0 0 24 24"><path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 01-8 0"/></svg>
      <span class="cart-count" id="cartCountPDP">0</span>
    </button>
  </div>

  <div class="pdp-body">

    <!-- Galerie -->
    <div class="pdp-gallery">
      <div class="pdp-main-img" id="pdpMainImg" onclick="openLightbox()">
        <button class="pdp-gallery-nav prev" onclick="event.stopPropagation();galleryNav(-1)">
          <svg viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg>
        </button>
        <button class="pdp-gallery-nav next" onclick="event.stopPropagation();galleryNav(1)">
          <svg viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg>
        </button>
      </div>
      <div class="pdp-thumbs" id="pdpThumbs"></div>
    </div>

    <!-- Infos -->
    <div class="pdp-info">
      <p class="pdp-brand" id="pdpBrand"></p>
      <h1 class="pdp-name" id="pdpName"></h1>

      <div class="pdp-price-block">
        <span class="pdp-price" id="pdpPrice"></span>
        <span class="pdp-old-price" id="pdpOldPrice" style="display:none"></span>
        <span class="pdp-discount" id="pdpDiscount" style="display:none"></span>
      </div>

      <!-- Tailles -->
      <div id="pdpSizesWrap" style="margin-bottom:2rem">
        <p class="pdp-section-title">Taille</p>
        <div class="pdp-sizes" id="pdpSizes"></div>
      </div>

      <!-- CTA -->
      <div class="pdp-cta">
        <button class="pdp-add-btn" id="pdpAddBtn" onclick="pdpAddToCart()">Ajouter au panier</button>
        <button class="pdp-wish-btn" id="pdpWishBtn" onclick="pdpToggleWish()">
          <svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
          Ajouter aux favoris
        </button>
      </div>

      <!-- Description -->
      <p class="pdp-desc" id="pdpDesc"></p>

      <!-- Méta -->
      <div class="pdp-meta">
        <span class="pdp-meta-item"><svg viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>Livraison offerte dès 150€</span>
        <span class="pdp-meta-item"><svg viewBox="0 0 24 24"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/></svg>Retours 30 jours</span>
        <span class="pdp-meta-item" id="pdpStockMeta"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></span>
        <span class="pdp-meta-item"><svg viewBox="0 0 24 24"><rect x="1" y="3" width="15" height="13"/><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/><circle cx="5.5" cy="18.5" r="2.5"/><circle cx="18.5" cy="18.5" r="2.5"/></svg>Expédié en 48h</span>
      </div>

      <!-- Accordéon -->
      <div class="pdp-accordion">
        <div class="pdp-acc-item">
          <button class="pdp-acc-trigger" onclick="toggleAcc(this)">
            Composition & Entretien
            <svg viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
          </button>
          <div class="pdp-acc-content"><p>100% matières sélectionnées. Lavage délicat recommandé. Voir étiquette pour instructions complètes.</p></div>
        </div>
        <div class="pdp-acc-item">
          <button class="pdp-acc-trigger" onclick="toggleAcc(this)">
            Livraison & Retours
            <svg viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
          </button>
          <div class="pdp-acc-content"><p>Livraison offerte en France dès 150€. Expédition sous 48h ouvrées. Retours gratuits sous 30 jours, article non porté avec étiquettes.</p></div>
        </div>
        <div class="pdp-acc-item">
          <button class="pdp-acc-trigger" onclick="toggleAcc(this)">
            Guide des tailles
            <svg viewBox="0 0 24 24"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
          </button>
          <div class="pdp-acc-content"><p>XS : 34–36 • S : 36–38 • M : 38–40 • L : 40–42 • XL : 42–44 • XXL : 44–46. En cas de doute, prenez la taille supérieure.</p></div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- LIGHTBOX -->
<div class="pdp-lightbox" id="pdpLightbox" onclick="closeLightbox()">
  <button class="pdp-lightbox-close" onclick="closeLightbox()">✕</button>
  <button class="pdp-lightbox-nav prev" onclick="event.stopPropagation();lightboxNav(-1)">‹</button>
  <img id="pdpLightboxImg" src="" alt="">
  <button class="pdp-lightbox-nav next" onclick="event.stopPropagation();lightboxNav(1)">›</button>
  <span class="pdp-lightbox-counter" id="pdpLightboxCounter"></span>
</div>

<!-- CART -->
<div class="cart-modal" id="cartModal">
  <div class="cart-backdrop" onclick="toggleCart()"></div>
  <div class="cart-panel">
    <div class="cart-header">
      <span class="cart-title">Mon Panier</span>
      <button class="cart-close" onclick="toggleCart()">✕</button>
    </div>
    <div class="cart-items" id="cartItems">
      <div class="cart-empty"><p>Panier vide</p><span>Ajoutez des pièces pour commencer</span></div>
    </div>
    <div class="cart-footer" id="cartFooter" style="display:none">
      <div class="cart-total">
        <span class="cart-total-label">Total</span>
        <span class="cart-total-amount" id="cartTotal">0,00 €</span>
      </div>
      <button class="checkout-btn">Passer la commande →</button>
    </div>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"><div class="toast-icon">✓</div><span id="toastMsg"></span></div>

<script>
// ════════════════════════════════════════════
// ⚙️  CONFIGURATION — Remplacez ces valeurs
// ════════════════════════════════════════════
const SUPABASE_URL      = 'https://gjwiroqpsikbhwjcruwf.supabase.co';
const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdqd2lyb3Fwc2lrYmh3amNydXdmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE2OTc2NTEsImV4cCI6MjA4NzI3MzY1MX0.8DKrtmhIZ7YpkntGg_s3sGWWDhe76mcrpY1Ei6h_aTs';
// ════════════════════════════════════════════

const isConfigured = SUPABASE_URL !== 'VOTRE_URL_SUPABASE';
let sbClient = null;
let allProducts = [];
let allCategories = [];
let currentFilter = 'Tous';
let selectedSizes = {};
let cart = [];

// ── INIT ──
async function init() {
  if (!isConfigured) {
    document.getElementById('configBanner').style.display = 'block';
    document.getElementById('mainNav').classList.add('with-banner');
    document.getElementById('marqueeWrap').classList.add('with-banner');
    renderSkeletons();
    return;
  }
  sbClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  await loadCategories();
  await loadProducts();
  initScrollObserver();
}

// ── CATEGORIES ──
async function loadCategories() {
  const { data, error } = await sbClient.from('categories').select('*').order('name');
  if (error) { console.error(error); return; }
  allCategories = data;
  renderCategories();
  renderFilterChips();
}

const CAT_COLORS = {
  femme: 'linear-gradient(145deg,#2d2520 0%,#1a1410 100%)',
  homme: 'linear-gradient(145deg,#1a2030 0%,#0d1520 100%)',
  enfant: 'linear-gradient(145deg,#2a1f2d 0%,#1a1020 100%)',
  accessoires: 'linear-gradient(145deg,#201a10 0%,#2a2015 100%)',
};

function renderCategories() {
  const grid = document.getElementById('categoriesGrid');
  grid.innerHTML = allCategories.map(cat => `
    <div class="cat-card" onclick="filterCat('${cat.name}')">
      <div class="cat-bg">
        <div class="cat-bg-inner" style="background:${CAT_COLORS[cat.slug] || 'linear-gradient(145deg,#1a1a1a,#2a2a2a)'}">
          <svg viewBox="0 0 200 200" width="120" height="120" xmlns="http://www.w3.org/2000/svg" opacity=".4">
            <text x="100" y="130" font-size="100" text-anchor="middle" fill="#c9a96e" font-family="serif">${cat.name[0]}</text>
          </svg>
        </div>
      </div>
      <div class="cat-info">
        <span class="cat-name">${cat.name}</span>
        <span class="cat-count" id="count-${cat.id}">… pièces</span>
      </div>
    </div>
  `).join('');
}

function renderFilterChips() {
  const chips = document.getElementById('filterChips');
  chips.innerHTML = `<button class="chip active" onclick="filterCat('Tous')">Tous</button>` +
    allCategories.map(c => `<button class="chip" onclick="filterCat('${c.name}')">${c.name}</button>`).join('');
}

// ── PRODUCTS ──
async function loadProducts() {
  renderSkeletons();
  const { data, error } = await sbClient
    .from('products')
    .select('*, categories(name, slug)')
    .eq('is_active', true)
    .order('created_at', { ascending: false });
  if (error) { console.error(error); showToast('Erreur de chargement'); return; }
  allProducts = data;
  allCategories.forEach(cat => {
    const count = allProducts.filter(p => p.category_id === cat.id).length;
    const el = document.getElementById(`count-${cat.id}`);
    if (el) el.textContent = `${count} pièce${count>1?'s':''}`;
  });
  renderProducts();
  injectHeroProduct();
}

// ── HERO RANDOM PRODUCT ──
let heroProduct = null;

function injectHeroProduct() {
  if (!allProducts.length) return;
  const withImg = allProducts.filter(p => {
    const img = (p.images && p.images.length) ? p.images[0] : p.image_url;
    return !!img && p.is_active !== false;
  });
  const pool = withImg.length ? withImg : allProducts;
  heroProduct = pool[Math.floor(Math.random() * pool.length)];
  const thumb = (heroProduct.images && heroProduct.images.length) ? heroProduct.images[0] : heroProduct.image_url;
  const inner = document.getElementById('heroImageInner');
  if (thumb) {
    inner.innerHTML = '<img src="'+thumb+'" alt="'+heroProduct.name+'" style="width:100%;height:100%;object-fit:cover;transition:transform .6s ease">';
  } else {
    inner.innerHTML = '<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;opacity:.2"><svg viewBox="0 0 100 120" width="120" xmlns="http://www.w3.org/2000/svg"><ellipse cx="50" cy="20" rx="14" ry="16" fill="#c9a96e"/><path d="M22,50 Q15,70 18,100 L82,100 Q85,70 78,50 Q65,38 50,36 Q35,38 22,50Z" fill="#c9a96e"/></svg></div>';
  }
  const badge = document.getElementById('heroBadge');
  badge.style.display = 'block';
  document.getElementById('heroBadgeName').textContent = heroProduct.name;
  document.getElementById('heroBadgePrice').textContent = Number(heroProduct.price).toFixed(2).replace('.', ',') + ' €';
}

window.heroOpenPDP = function() {
  if (heroProduct) openPDP(heroProduct.id);
};

function renderSkeletons(n=8) {
  document.getElementById('productsGrid').innerHTML = Array(n).fill(0).map(() => `
    <div class="skeleton-card">
      <div class="skeleton-img"></div>
      <div style="padding:.5rem 0">
        <div class="skeleton-line short"></div>
        <div class="skeleton-line"></div>
        <div class="skeleton-line short"></div>
      </div>
    </div>
  `).join('');
}

function renderProducts(filter=currentFilter, sortVal='default') {
  let list = filter === 'Tous' ? [...allProducts] : allProducts.filter(p => p.categories?.name === filter);
  if (sortVal === 'price-asc')  list.sort((a,b) => a.price - b.price);
  if (sortVal === 'price-desc') list.sort((a,b) => b.price - a.price);
  if (sortVal === 'new')        list.sort((a,b) => b.is_new - a.is_new);

  const grid = document.getElementById('productsGrid');
  if (!list.length) {
    grid.innerHTML = `<div class="empty-state"><p>Aucun produit trouvé</p><span>Revenez bientôt ou explorez d'autres catégories</span></div>`;
    return;
  }
  grid.innerHTML = list.map(p => {
    const sizes = p.sizes || [];
    const unavail = p.unavailable_sizes || [];
    const hasSale = !!p.old_price;
    const thumb = (p.images && p.images.length) ? p.images[0] : p.image_url;
    return `
    <div class="product-card" data-id="${p.id}" onclick="openPDP('${p.id}')">
      <div class="product-img-wrap">
        ${thumb
          ? `<img class="product-thumb" src="${thumb}" alt="${p.name}" loading="lazy" onerror="this.style.display='none';this.nextSibling.style.display='flex'">`
          : ''}
        <div class="product-thumb placeholder-img" style="${thumb?'display:none':''}">
          <svg viewBox="0 0 100 120" width="80" xmlns="http://www.w3.org/2000/svg" opacity=".3">
            <ellipse cx="50" cy="20" rx="14" ry="16" fill="#c9a96e"/>
            <path d="M22,50 Q15,70 18,100 L82,100 Q85,70 78,50 Q65,38 50,36 Q35,38 22,50Z" fill="#c9a96e"/>
          </svg>
        </div>
        ${p.is_new && !hasSale ? '<span class="badge-new">Nouveau</span>' : ''}
        ${hasSale ? '<span class="badge-sale">Soldes</span>' : ''}
        <button class="wishlist-btn" id="wish-${p.id}" onclick="toggleWish('${p.id}',event)">
          <svg viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
        </button>
        <div class="product-actions">
          <div class="size-quick" id="sizes-${p.id}">
            ${sizes.map(s => `<button class="size-btn${unavail.includes(s)?' unavailable':''}" onclick="selectSize('${p.id}','${s}',event)" ${unavail.includes(s)?'disabled':''}>${s}</button>`).join('')}
          </div>
          <button class="add-to-cart" onclick="event.stopPropagation();addToCart('${p.id}')">Ajouter au panier</button>
        </div>
      </div>
      <div class="product-meta">
        <p class="product-brand">${p.brand || 'La Manufacture'}</p>
        <p class="product-name">${p.name}</p>
        <div class="product-price">
          <span class="price-current">${Number(p.price).toFixed(2).replace('.',',')} €</span>
          ${p.old_price ? `<span class="price-old">${Number(p.old_price).toFixed(2).replace('.',',')} €</span>` : ''}
        </div>
      </div>
      <button class="add-mobile" onclick="event.stopPropagation();addToCart('${p.id}')">+ Ajouter au panier</button>
    </div>`;
  }).join('');
}

function filterCat(cat) {
  currentFilter = cat;
  document.querySelectorAll('.chip').forEach(c => {
    c.classList.toggle('active', c.textContent.trim() === cat || (cat==='Tous' && c.textContent.trim()==='Tous'));
  });
  renderProducts(cat);
  document.getElementById('products').scrollIntoView({behavior:'smooth'});
}
window.filterCat = filterCat;

function sortProducts(val) { renderProducts(currentFilter, val); }
window.sortProducts = sortProducts;

function selectSize(id, size, e) {
  e.stopPropagation();
  selectedSizes[id] = size;
  document.querySelectorAll(`#sizes-${id} .size-btn`).forEach(b => b.classList.remove('selected'));
  e.target.classList.add('selected');
}
window.selectSize = selectSize;

function toggleWish(id, e) {
  e.stopPropagation();
  const btn = document.getElementById(`wish-${id}`);
  btn.classList.toggle('active');
  showToast(btn.classList.contains('active') ? 'Ajouté aux favoris ♥' : 'Retiré des favoris');
}
window.toggleWish = toggleWish;

// ── CART ──
function addToCart(id) {
  const p = allProducts.find(x => x.id === id);
  if (!p) return;
  const avail = (p.sizes||[]).filter(s=>!(p.unavailable_sizes||[]).includes(s));
  const size = selectedSizes[id] || avail[0] || 'TU';
  const existing = cart.find(i => i.id===id && i.size===size);
  if (existing) existing.qty++;
  else cart.push({...p, size, qty:1});
  updateCartUI();
  showToast(`${p.name} (${size}) ajouté`);
}
window.addToCart = addToCart;

function removeFromCart(id, size) {
  cart = cart.filter(i => !(i.id===id && i.size===size));
  updateCartUI();
}
window.removeFromCart = removeFromCart;

function changeQty(id, size, delta) {
  const item = cart.find(i => i.id===id && i.size===size);
  if (!item) return;
  item.qty += delta;
  if (item.qty <= 0) removeFromCart(id, size);
  else updateCartUI();
}
window.changeQty = changeQty;

function updateCartUI() {
  const count = cart.reduce((s,i) => s+i.qty, 0);
  const total = cart.reduce((s,i) => s+Number(i.price)*i.qty, 0);
  document.getElementById('cartCount').textContent = count;
  const el = document.getElementById('cartCountPDP'); if (el) el.textContent = count;
  const items = document.getElementById('cartItems');
  const footer = document.getElementById('cartFooter');
  if (!cart.length) {
    items.innerHTML = `<div class="cart-empty"><p>Panier vide</p><span>Ajoutez des pièces pour commencer</span></div>`;
    footer.style.display = 'none';
  } else {
    items.innerHTML = cart.map(i => `
      <div class="cart-item">
        <div class="cart-item-img">
          ${i.image_url ? `<img src="${i.image_url}" alt="${i.name}">` : `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:var(--creme)"><svg viewBox="0 0 60 70" width="40" xmlns="http://www.w3.org/2000/svg" opacity=".4"><ellipse cx="30" cy="12" rx="9" ry="10" fill="#c9a96e"/><path d="M12,28 Q8,40 10,65 L50,65 Q52,40 48,28 Q40,22 30,21 Q20,22 12,28Z" fill="#c9a96e"/></svg></div>`}
        </div>
        <div class="cart-item-info">
          <p class="cart-item-name">${i.name}</p>
          <p class="cart-item-size">Taille: ${i.size}</p>
          <p class="cart-item-price">${(Number(i.price)*i.qty).toFixed(2).replace('.',',')} €</p>
          <div class="cart-qty">
            <button class="qty-btn" onclick="changeQty('${i.id}','${i.size}',-1)">−</button>
            <span class="qty-val">${i.qty}</span>
            <button class="qty-btn" onclick="changeQty('${i.id}','${i.size}',1)">+</button>
          </div>
          <button class="cart-item-remove" onclick="removeFromCart('${i.id}','${i.size}')">Retirer</button>
        </div>
      </div>
    `).join('');
    footer.style.display = 'block';
    document.getElementById('cartTotal').textContent = total.toFixed(2).replace('.',',') + ' €';
  }
}

function toggleCart() {
  document.getElementById('cartModal').classList.toggle('open');
  document.body.style.overflow = document.getElementById('cartModal').classList.contains('open') ? 'hidden' : '';
}
window.toggleCart = toggleCart;

// ── MISC ──
function showToast(msg) {
  const t = document.getElementById('toast');
  document.getElementById('toastMsg').textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2800);
}

function subscribeNewsletter() {
  const inp = document.getElementById('emailInput');
  if (inp.value && inp.value.includes('@')) { showToast('Inscription confirmée ! Merci.'); inp.value=''; }
  else showToast('Veuillez entrer un email valide.');
}
window.subscribeNewsletter = subscribeNewsletter;

function toggleMobileMenu() { document.getElementById('mobileMenu').classList.toggle('open'); }
window.toggleMobileMenu = toggleMobileMenu;

function initScrollObserver() {
  const obs = new IntersectionObserver(es => es.forEach(e => { if(e.isIntersecting) e.target.classList.add('visible'); }), {threshold:.1});
  document.querySelectorAll('.fade-up').forEach(el => obs.observe(el));
}

// Custom cursor
const cursor = document.getElementById('cursor');
const ring   = document.getElementById('cursor-ring');
document.addEventListener('mousemove', e => {
  cursor.style.left = e.clientX+'px'; cursor.style.top = e.clientY+'px';
  setTimeout(()=>{ ring.style.left=e.clientX+'px'; ring.style.top=e.clientY+'px'; },60);
});
document.querySelectorAll('button,a,.product-card,.cat-card').forEach(el => {
  el.addEventListener('mouseenter',()=>{ cursor.style.width='16px'; cursor.style.height='16px'; ring.style.width='50px'; ring.style.height='50px'; });
  el.addEventListener('mouseleave',()=>{ cursor.style.width='10px'; cursor.style.height='10px'; ring.style.width='36px'; ring.style.height='36px'; });
});

// ══════════════════════════════════════════════
// ── PAGE PRODUIT (PDP) ──
// ══════════════════════════════════════════════
let pdpProduct   = null;
let pdpImages    = [];
let pdpImgIndex  = 0;
let pdpWished    = new Set();
let pdpSize      = null;

function openPDP(id) {
  const p = allProducts.find(x => x.id === id);
  if (!p) return;
  pdpProduct  = p;
  pdpImages   = (p.images && p.images.length) ? p.images : (p.image_url ? [p.image_url] : []);
  pdpImgIndex = 0;
  pdpSize     = null;

  document.getElementById('pdpBreadcrumb').innerHTML =
    `Boutique / <span>${p.categories?.name || ''}</span> / ${p.name}`;

  document.getElementById('pdpBrand').textContent = p.brand || 'La Manufacture';
  document.getElementById('pdpName').textContent  = p.name;

  document.getElementById('pdpPrice').textContent = Number(p.price).toFixed(2).replace('.',',') + ' €';
  const oldEl = document.getElementById('pdpOldPrice');
  const discEl = document.getElementById('pdpDiscount');
  if (p.old_price) {
    oldEl.textContent  = Number(p.old_price).toFixed(2).replace('.',',') + ' €';
    oldEl.style.display = 'inline';
    const pct = Math.round((1 - p.price / p.old_price) * 100);
    discEl.textContent  = `−${pct}%`;
    discEl.style.display = 'inline';
  } else {
    oldEl.style.display = discEl.style.display = 'none';
  }

  const sizes   = p.sizes || [];
  const unavail = p.unavailable_sizes || [];
  const sizesEl = document.getElementById('pdpSizes');
  if (sizes.length) {
    sizesEl.innerHTML = sizes.map(s => `
      <button class="pdp-size-btn${unavail.includes(s)?' na-size':''}"
        onclick="${unavail.includes(s)?'':'selectPDPSize(\''+s+'\')'}"
        ${unavail.includes(s)?'disabled':''}>${s}</button>
    `).join('');
    document.getElementById('pdpSizesWrap').style.display = 'block';
  } else {
    document.getElementById('pdpSizesWrap').style.display = 'none';
  }

  document.getElementById('pdpDesc').textContent = p.description || '';

  document.getElementById('pdpStockMeta').innerHTML =
    `<svg viewBox="0 0 24 24" width="14" height="14" stroke="var(--or)" fill="none" stroke-width="1.5"><polyline points="20 6 9 17 4 12"/></svg>
    ${p.stock > 0 ? `${p.stock} en stock` : 'Disponible'}`;

  renderPDPGallery();

  const wb = document.getElementById('pdpWishBtn');
  wb.classList.toggle('active', pdpWished.has(id));

  const overlay = document.getElementById('pdpOverlay');
  overlay.classList.add('open');
  overlay.scrollTop = 0;
  document.body.style.overflow = 'hidden';

  syncCartCount();
}

function renderPDPGallery() {
  const mainEl = document.getElementById('pdpMainImg');
  const thumbEl = document.getElementById('pdpThumbs');

  if (!pdpImages.length) {
    mainEl.innerHTML = `
      <div class="placeholder-gallery">
        <svg viewBox="0 0 100 120" width="100" xmlns="http://www.w3.org/2000/svg" opacity=".2">
          <ellipse cx="50" cy="20" rx="14" ry="16" fill="#c9a96e"/>
          <path d="M22,50 Q15,70 18,100 L82,100 Q85,70 78,50 Q65,38 50,36 Q35,38 22,50Z" fill="#c9a96e"/>
        </svg>
      </div>`;
    thumbEl.innerHTML = '';
    return;
  }

  const showNav = pdpImages.length > 1;
  mainEl.innerHTML = `
    ${showNav ? `<button class="pdp-gallery-nav prev" onclick="event.stopPropagation();galleryNav(-1)"><svg viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg></button>` : ''}
    <img src="${pdpImages[pdpImgIndex]}" alt="${pdpProduct.name}" style="width:100%;height:100%;object-fit:cover">
    ${showNav ? `<button class="pdp-gallery-nav next" onclick="event.stopPropagation();galleryNav(1)"><svg viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg></button>` : ''}
  `;

  thumbEl.innerHTML = pdpImages.map((url, i) => `
    <div class="pdp-thumb${i===0?' active':''}" onclick="setGalleryIndex(${i})">
      <img src="${url}" alt="${pdpProduct.name} ${i+1}" loading="lazy"
        onerror="this.parentElement.style.display='none'">
    </div>
  `).join('');
}

function setGalleryIndex(i) {
  pdpImgIndex = i;
  const img = document.querySelector('#pdpMainImg img');
  if (img) img.src = pdpImages[i];
  document.querySelectorAll('.pdp-thumb').forEach((t,j) => t.classList.toggle('active', j===i));
}

function galleryNav(dir) {
  if (!pdpImages.length) return;
  pdpImgIndex = (pdpImgIndex + dir + pdpImages.length) % pdpImages.length;
  setGalleryIndex(pdpImgIndex);
}
window.galleryNav = galleryNav;
window.setGalleryIndex = setGalleryIndex;

function selectPDPSize(s) {
  pdpSize = s;
  document.querySelectorAll('.pdp-size-btn').forEach(b => b.classList.toggle('selected-size', b.textContent.trim()===s));
}
window.selectPDPSize = selectPDPSize;

function pdpAddToCart() {
  if (!pdpProduct) return;
  const sizes  = pdpProduct.sizes || [];
  const unavail = pdpProduct.unavailable_sizes || [];
  const avail  = sizes.filter(s => !unavail.includes(s));
  const size   = pdpSize || avail[0] || 'TU';
  if (avail.length && !pdpSize) { showToast('Veuillez choisir une taille'); return; }
  const existing = cart.find(i => i.id===pdpProduct.id && i.size===size);
  if (existing) existing.qty++;
  else cart.push({...pdpProduct, size, qty:1});
  updateCartUI();
  showToast(`${pdpProduct.name} (${size}) ajouté`);
}
window.pdpAddToCart = pdpAddToCart;

function pdpToggleWish() {
  if (!pdpProduct) return;
  const id = pdpProduct.id;
  const btn = document.getElementById('pdpWishBtn');
  if (pdpWished.has(id)) { pdpWished.delete(id); btn.classList.remove('active'); showToast('Retiré des favoris'); }
  else                   { pdpWished.add(id);    btn.classList.add('active');    showToast('Ajouté aux favoris ♥'); }
  const wb = document.getElementById(`wish-${id}`);
  if (wb) wb.classList.toggle('active', pdpWished.has(id));
}
window.pdpToggleWish = pdpToggleWish;

function closePDP() {
  document.getElementById('pdpOverlay').classList.remove('open');
  document.body.style.overflow = '';
  closeLightbox();
}
window.closePDP = closePDP;

function openLightbox() {
  if (!pdpImages.length) return;
  document.getElementById('pdpLightboxImg').src = pdpImages[pdpImgIndex];
  document.getElementById('pdpLightboxCounter').textContent = `${pdpImgIndex+1} / ${pdpImages.length}`;
  document.getElementById('pdpLightbox').classList.add('open');
}
window.openLightbox = openLightbox;

function closeLightbox() {
  document.getElementById('pdpLightbox').classList.remove('open');
}
window.closeLightbox = closeLightbox;

function lightboxNav(dir) {
  if (!pdpImages.length) return;
  pdpImgIndex = (pdpImgIndex + dir + pdpImages.length) % pdpImages.length;
  document.getElementById('pdpLightboxImg').src = pdpImages[pdpImgIndex];
  document.getElementById('pdpLightboxCounter').textContent = `${pdpImgIndex+1} / ${pdpImages.length}`;
  setGalleryIndex(pdpImgIndex);
}
window.lightboxNav = lightboxNav;

function toggleAcc(btn) {
  const content = btn.nextElementSibling;
  const isOpen  = content.classList.contains('open');
  document.querySelectorAll('.pdp-acc-content').forEach(c => c.classList.remove('open'));
  document.querySelectorAll('.pdp-acc-trigger').forEach(b => b.classList.remove('open'));
  if (!isOpen) { content.classList.add('open'); btn.classList.add('open'); }
}
window.toggleAcc = toggleAcc;

document.addEventListener('keydown', e => {
  if (e.key === 'Escape') {
    if (document.getElementById('pdpLightbox').classList.contains('open')) { closeLightbox(); return; }
    if (document.getElementById('pdpOverlay').classList.contains('open'))  { closePDP();     return; }
  }
  if (document.getElementById('pdpOverlay').classList.contains('open')) {
    if (e.key === 'ArrowLeft')  galleryNav(-1);
    if (e.key === 'ArrowRight') galleryNav(1);
  }
});

function syncCartCount() {
  const count = cart.reduce((s,i) => s+i.qty, 0);
  const el = document.getElementById('cartCountPDP');
  if (el) el.textContent = count;
}

window.openPDP = openPDP;

init();
</script>
</body>
</html>
